# 反向编程工具：代码Bug注入助手 🐞

## 项目概述 📝

本项目是一个基于Gradio的交互式代码Bug注入工具，旨在为用户输入的代码添加各种"有趣"的bug，支持多种编程语言和不同的注入方式。无论是用于编程练习（让学习者寻找并修复bug），还是单纯的技术趣味体验，都能提供便捷的功能支持。工具采用粉蓝色系二次元风格界面，视觉效果清新活泼 ✨。



**项目持续更新中！**




## 核心功能详解 🔍

### 1. 多语言代码支持 🌐
工具支持多种主流编程语言，包括：
- Python
- JavaScript
- Java

每种语言都有针对性的bug注入策略，确保注入的bug符合该语言的语法特性和常见错误模式（定义于`utils.py`的`SUPPORTED_LANGUAGES`中）。


### 2. 两种Bug注入方法 🛠️

#### （1）预设方法注入 🎯
基于规则的bug注入方式，通过预定义的错误模式为代码添加bug。支持的bug类型丰富多样，例如：
- **语法错误**：如多余/缺失的分号、括号不匹配、缩进错误等
- **逻辑错误**：如"差一错误"（循环边界错误）、比较运算符混淆（`==`与`=`）、逻辑运算符替换（`and`与`or`）等
- **变量/函数错误**：如变量名拼写错误（`count`→`counter`）、函数调用参数缺失、字典键名错误等
- **运算错误**：如数学运算符替换（`*`→`/`、`+`→`-`）、字符串连接方式错误等

预设方法的具体实现位于`bug_injector.py`，每种错误类型对应独立的注入函数，每次会随机选择2-5种不同类型的bug进行注入。


#### （2）Ollama模型注入 🤖
借助本地Ollama大语言模型进行智能bug注入，需要用户本地运行Ollama服务。该方式的特点包括：
- 支持多种Ollama模型（自动获取本地可用模型列表）
- 能生成更隐蔽、更符合代码逻辑上下文的bug
- 至少注入2种不同类型的bug，避免简单重复的错误

Ollama交互逻辑位于`ollama_handler.py`，包括服务可用性检查、模型列表获取、提示词构建及代码提取等功能。


### 3. 交互式界面体验 🖥️
通过Gradio构建的可视化界面，操作流程简单直观：
- 代码输入区：支持语法高亮，可直接输入或粘贴代码
- 方法选择区：可切换"预设方法"或"Ollama模型"注入方式
- 模型选择：当使用Ollama时，自动显示可用模型下拉列表
- 视觉设计：粉蓝色系二次元风格，包含渐变背景、浮动装饰元素及动画效果，提升使用体验


## 项目结构 📂

```
项目根目录
├── start.py           # 主程序入口，构建Gradio界面并处理核心逻辑
├── ollama_handler.py  # Ollama服务交互模块，处理模型调用与响应解析
├── bug_injector.py    # 预设bug注入模块，实现各类语言的规则化bug注入
├── utils.py           # 工具模块，定义支持的语言及对应bug注入函数
├── test.py            # 任务管理相关测试代码（辅助模块）
└── requirements.txt   # 项目依赖清单
```

- **start.py**：核心模块，定义界面布局、CSS样式及用户交互逻辑，调用其他模块完成bug注入流程。
- **ollama_handler.py**：实现与Ollama本地服务的通信，包括服务可用性检测、模型列表获取、bug注入提示词生成及响应处理。
- **bug_injector.py**：包含针对Python、JavaScript、Java的预设bug注入函数，通过正则替换等方式添加各类错误。
- **utils.py**：维护支持的编程语言列表，及每种语言对应的bug注入函数映射关系。
- **requirements.txt**：声明项目依赖，包括`gradio>=3.40.0`和`requests>=2.31.0`。


## 使用方法 📖

### 1. 环境准备 🛠️
- 安装依赖：执行`pip install -r requirements.txt`
- （可选，用于Ollama方法）本地运行Ollama服务，并下载至少一个模型（如`llama2`、`codellama`等）


### 2. 启动工具 🚀
运行命令：`python start.py`，程序会自动启动Gradio界面（默认地址：http://localhost:7860）。


### 3. 操作步骤 👣
1. 在"输入代码"区域填写或粘贴需要注入bug的代码（选择对应语言）
2. 在"Bug注入方法设置"中选择注入方式：
   - 选择"预设方法"：直接使用预定义规则注入bug
   - 选择"Ollama模型"：从下拉列表选择可用模型（需Ollama服务正常运行）
3. 点击"提交"按钮，工具会生成并展示注入bug后的代码


## 备注 💡
代码由Qwen-Coder模型编写。